<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="js/jquery-2.1.4.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="branchsample.js"></script>
<script type="text/javascript">

    (function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode banner closeBanner creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode".split(" "), 0);

    branch.init('key_live_hfBflnbiUgeSmTwa7W7jbiddzEdJgp6f', function(err, data) {
        branch.banner(
        {
          icon: 'https://res.cloudinary.com/hrscywv4p/image/upload/c_limit,h_1440,w_720,f_auto/ecdl2ykvex3da5avzhz0.png',
          title: 'Pixie Scientific',
          description: 'App for Pixie Smart Pads!',
          openAppButtonText: 'Open',
          downloadAppButtonText: 'Get',
          reviewCount: 1000,
          rating: 5,
          iframe: true,
          showMobile: true,
          showDesktop: true,
          disableHide: false,
          forgetHide: true
        },
        data
      );

      branch.deepview(
      {
        'channel': 'mobile_web',
        'feature': 'deepview',
        'campaign': 'uti_testing',
        'stage': 'web_traffic_1',
        data : {
          '$fallback_url': 'https://www.pixiescientific.com/',
          '$deeplink_path': 'page/1234',
          'user_profile': '7890',
          'page_id': '1234',
          'custom_data': branch.data()
        }
      },
      {
        'open_app': true
      });
    });

  function getDeeplink () {
    $.ajax({
      url: "https://api.branch.io/v1/url",
      type: "POST",
      headers: {
          'Access-Control-Allow-Origin': '*'
      },
      data: {"branch_key":"key_live_hfBflnbiUgeSmTwa7W7jbiddzEdJgp6f"},
      dataType: "JSONP",
      contentType: "application/json",
      success: onSuccess,
      failure: onFailure,
      complete: onComplete
    });
  };

  function onSuccess (data) {
    $('.response').html(data["url"]);
  };

  function onFailure (data) {
    console.log("fail");
  };

  function onComplete (data){
    console.log("done");
  };
</script>
<title>Pixie Scientific</title>


<link rel="stylesheet" type="text/css" href="css/bootstrap-theme.min.css">
<link href="css/bootstrap.css" rel="stylesheet">
<link href="branchsample.css" rel="stylesheet">

</head>

<body>

	<div class="container">

      <div class="row col-lg-8 col-lg-offset-2">
      <h2>Pixie Scientific</h2>
    </div>
    <section>
      <div class="row col-lg-8 col-lg-offset-2">
        <div class="group">
        <h4>Standard Deeplink</h4>
          <button class="btn btn-info" onclick="branch.deepviewCta()">Go!</button>
        </div>
      </div>
    </section>
    <section>
      <div class="row col-lg-8 col-lg-offset-2">
        <div class="group">
         <h4>Custom Deepview Link</h4>
          <button class="btn btn-info" onclick="getDeeplink()">Generate</button>
        </div>
      </div>
      <div class="row col-lg-8 col-lg-offset-2">
        <h5>Response:</h5>
        <pre class="response">Click the button!</pre>
      </div>
    </section>
  </div>

 </body>
 </html>